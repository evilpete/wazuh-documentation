.. Copyright (C) 2018 Wazuh, Inc.

.. _wodle_vuln_detector:

wodle name="vulnerability-detector"
====================================

.. versionadded:: 3.2.0

.. topic:: XML section name

	.. code-block:: xml

		<wodle name="vulnerability-detector">
		</wodle>

Configuration options of the Vulnerability detector wodle.

Options
-------

- `disabled`_
- `interval`_
- `run_on_start`_
- `update_ubuntu_oval`_
- `update_redhat_oval`_

+---------------------------+-----------------------------+
| Options                   | Allowed values              |
+===========================+=============================+
| `disabled`_               | yes, no                     |
+---------------------------+-----------------------------+
| `interval`_               | A positive number (seconds) |
+---------------------------+-----------------------------+
| `run_on_start`_           | yes, no                     |
+---------------------------+-----------------------------+
| `update_ubuntu_oval`_     | yes, no                     |
+---------------------------+-----------------------------+
| `update_redhat_oval`_     | yes, no                     |
+---------------------------+-----------------------------+


disabled
^^^^^^^^

Disable the Vulnerability detector wodle.

+--------------------+-----------------------------+
| **Default value**  | yes                         |
+--------------------+-----------------------------+
| **Allowed values** | yes, no                     |
+--------------------+-----------------------------+

interval
^^^^^^^^

Time between vulnerabilities detections.

+--------------------+------------------------------------------------------------------------------------------------------------------------------------------+
| **Default value**  | 1d                                                                                                                                       |
+--------------------+------------------------------------------------------------------------------------------------------------------------------------------+
| **Allowed values** | A positive number that should contain a suffix character indicating a time unit, such as, s (seconds), m (minutes), h (hours), d (days). |
+--------------------+------------------------------------------------------------------------------------------------------------------------------------------+

run_on_start
^^^^^^^^^^^^

Runs updates and detections immediately when service is started.

+--------------------+---------+
| **Default value**  | yes     |
+--------------------+---------+
| **Allowed values** | yes, no |
+--------------------+---------+

update_ubuntu_oval
^^^^^^^^^^^^^^^^^^^

Updates the Ubuntu OVAL

+--------------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Default value**  | yes                                                                                                                                                                       |
+--------------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Allowed values** | yes, no |                                                                                                                                                                 |
+--------------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |         | Time between Ubuntu OVAL updates.                                                                                                                               |
+                    + interval+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
|                    |         | **Allowed values** |  A positive number that should contain a suffix character indicating a time unit, such as, s (seconds), m (minutes), h (hours), d (days).  |
+ **Allowed tags**   +---------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
|                    |         | Ubuntu OVAL versions to download.                                                                                                                               |
+                    + version +--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
|                    |         | **Allowed values** | Compatible Ubuntu versions separated by commas.                                                                                            |
+--------------------+---------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+

update_redhat_oval
^^^^^^^^^^^^^^^^^^^

Updates the Redhat OVAL

+--------------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Default value**  | yes                                                                                                                                                                       |
+--------------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Allowed values** | yes, no |                                                                                                                                                                 |
+--------------------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |         | Time between Redhat OVAL updates.                                                                                                                               |
+                    + interval+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
|                    |         | **Allowed values** |  A positive number that should contain a suffix character indicating a time unit, such as, s (seconds), m (minutes), h (hours), d (days).  |
+ **Allowed tags**   +---------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
|                    |         | Redhat OVAL versions to download.                                                                                                                               |
+                    + version +--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
|                    |         | **Allowed values** | Compatible Redhat versions separated by commas.                                                                                            |
+--------------------+---------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+

Example of configuration
------------------------

.. code-block:: xml

	<wodle name="vulnerability-detector">
	  <disabled>no</disabled>
	  <interval>1d</interval>
	  <run_on_start>yes</run_on_start>
	  <update_ubuntu_oval interval="1d" version="16,14">yes</update_ubuntu_oval>
	  <update_redhat_oval interval="1d" version="7,6">yes</update_redhat_oval>
	</wodle>



.. note:: See the :doc:`Vulnerability detector section<../../capabilities/vulnerability-detection>` to obtain more information about this module.
